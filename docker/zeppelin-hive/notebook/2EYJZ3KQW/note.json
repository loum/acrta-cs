{
  "paragraphs": [
    {
      "text": "%hive\n-- Create the \"drive_temp\" working space in prepration for features.\nCREATE TABLE IF NOT EXISTS drive_temp\nSTORED AS PARQUET LOCATION \u0027hdfs:///user/hive/warehouse/drive_temp\u0027 TBLPROPERTIES (\"parquet.compression\"\u003d\"SNAPPY\")\nAS SELECT vehicle_id,\n    trip_id,\n    datetime,\n    previous_velocity,\n    velocity,\n    acceleration,\n    SUM(group_start) OVER (PARTITION BY vehicle_id, trip_id ORDER BY datetime) AS acceleration_group\nFROM (\n    SELECT vehicle_id,\n        trip_id,\n        datetime,\n        previous_velocity,\n        velocity,\n        acceleration,\n        CASE WHEN SIGN(acceleration) !\u003d SIGN(LAG(acceleration, 1, 0) OVER (PARTITION BY vehicle_id, trip_id ORDER BY datetime)) AND t1.acceleration !\u003d 0 THEN 1 ELSE 0 END AS group_start\n    FROM (\n        SELECT vehicle_id,\n            trip_id,\n            datetime,\n            LAG(velocity, 1, 0) OVER (PARTITION BY vehicle_id, trip_id ORDER BY datetime) AS previous_velocity,\n            velocity,\n            (velocity - LAG(velocity, 1, 0) OVER (PARTITION BY vehicle_id, trip_id ORDER BY datetime)) AS acceleration\n        FROM drive\n    ) t1\n) t2",
      "user": "anonymous",
      "dateUpdated": "2020-01-21 04:39:25.869",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : -1"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1579394072314_1180159791",
      "id": "20200119-003432_1731334026",
      "dateCreated": "2020-01-19 00:34:32.314",
      "dateStarted": "2020-01-21 04:39:25.930",
      "dateFinished": "2020-01-21 04:40:30.916",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%hive\n-- Create the \"engine_temp\" working space in prepration for features.\nCREATE TABLE IF NOT EXISTS engine_temp\nSTORED AS PARQUET LOCATION \u0027hdfs:///user/hive/warehouse/engine_temp\u0027 TBLPROPERTIES (\"parquet.compression\"\u003d\"SNAPPY\")\nAS SELECT drive.vehicle_id,\n    drive.trip_id,\n    drive.datetime,\n    drive.eng_load,\n    drive.rpm,\n    vehicle.make,\n    vehicle.max_torque,\n    vehicle.max_horsepower,\n    vehicle.max_horsepower_rpm,\n    (drive.eng_load / 255 * vehicle.max_torque * drive.rpm / 5252) AS active_horsepower,\n    (drive.eng_load / 255 * vehicle.max_torque * drive.rpm / 5252 / vehicle.max_horsepower) AS horsepower_utilization,\n    (drive.eng_load / 255) AS torque_utilization,\n    (drive.rpm / vehicle.max_horsepower_rpm) AS rpm_utilization\nFROM drive\nINNER JOIN vehicle\nON drive.vehicle_id \u003d vehicle.vehicle_id\nWHERE drive.vehicle_id \u003d 1000500\nAND drive.trip_id \u003d \"152af94305154e5681323461de8e4ce6\"",
      "user": "anonymous",
      "dateUpdated": "2020-01-21 04:40:37.419",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : -1"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1579522541215_660352929",
      "id": "20200120-121541_636784344",
      "dateCreated": "2020-01-20 12:15:41.215",
      "dateStarted": "2020-01-21 04:40:37.446",
      "dateFinished": "2020-01-21 04:40:52.147",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%hive\n",
      "user": "anonymous",
      "dateUpdated": "2020-01-20 10:45:46.241",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {}
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1579424054042_1074916027",
      "id": "20200119-085414_29732436",
      "dateCreated": "2020-01-19 08:54:14.042",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "acrta-dwh",
  "id": "2EYJZ3KQW",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "spark:shared_process": [],
    "hive:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}