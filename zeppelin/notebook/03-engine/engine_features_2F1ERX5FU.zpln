{
  "paragraphs": [
    {
      "text": "%hive\n-- Every vehicle aggregated at week start date (Monday) for the complete week in YYYY-MM-DD format.\n--\nCREATE TABLE IF NOT EXISTS engine_features\nSTORED AS PARQUET LOCATION \u0027hdfs:///user/hive/warehouse/engine_features\u0027 TBLPROPERTIES (\"parquet.compression\"\u003d\"SNAPPY\")\nAS SELECT torque_util_60pct_cnt.vehicle_id AS vehicle_id,\n    torque_util_60pct_cnt.week_start_date AS week_start_date,\n    torque_util_60pct_cnt.ft_torque_util_60pct_s AS ft_torque_util_60pct_s,\n    torque_util_70pct_cnt.ft_torque_util_70pct_s AS ft_torque_util_70pct_s,\n    torque_util_80pct_cnt.ft_torque_util_80pct_s AS ft_torque_util_80pct_s,\n    torque_util_90pct_cnt.ft_torque_util_90pct_s AS ft_torque_util_90pct_s,\n    hp_util_50pct_cnt.ft_horsepower_util_50pct_s AS ft_horsepower_util_50pct_s,\n    hp_util_60pct_cnt.ft_horsepower_util_60pct_s AS ft_horsepower_util_60pct_s,\n    hp_util_70pct_cnt.ft_horsepower_util_70pct_s AS ft_horsepower_util_70pct_s,\n    hp_util_80pct_cnt.ft_horsepower_util_80pct_s AS ft_horsepower_util_80pct_s,\n    rpm_util_50pct_cnt.ft_rpm_util_50pct_s AS ft_rpm_util_50pct_s,\n    rpm_util_60pct_cnt.ft_rpm_util_60pct_s AS ft_rpm_util_60pct_s\nFROM (\n    SELECT vehicle_id, week_start_date, COUNT(*) AS ft_torque_util_60pct_s\n    FROM (\n        SELECT vehicle_id, week_start_date\n        FROM engine_temp\n        WHERE torque_utilization \u003e\u003d 0.6 AND torque_utilization \u003c 0.7\n    ) torque_util_60pct\n    GROUP BY vehicle_id, week_start_date\n) torque_util_60pct_cnt\nLEFT OUTER JOIN (\n    SELECT vehicle_id, week_start_date, COUNT(*) AS ft_torque_util_70pct_s\n    FROM (\n        SELECT vehicle_id, week_start_date\n        FROM engine_temp\n        WHERE torque_utilization \u003e\u003d 0.7 AND torque_utilization \u003c 0.8\n    ) torque_util_70pct\n    GROUP BY vehicle_id, week_start_date\n) torque_util_70pct_cnt\nON (\n    torque_util_60pct_cnt.vehicle_id \u003d torque_util_70pct_cnt.vehicle_id\n    AND torque_util_60pct_cnt.week_start_date \u003d torque_util_70pct_cnt.week_start_date\n)\n\nLEFT OUTER JOIN (\n    SELECT vehicle_id, week_start_date, COUNT(*) AS ft_torque_util_80pct_s\n    FROM (\n        SELECT vehicle_id, week_start_date\n        FROM engine_temp\n        WHERE torque_utilization \u003e\u003d 0.8 AND torque_utilization \u003c 0.9\n    ) torque_util_80pct\n    GROUP BY vehicle_id, week_start_date\n) torque_util_80pct_cnt\nON (\n    torque_util_60pct_cnt.vehicle_id \u003d torque_util_80pct_cnt.vehicle_id\n    AND torque_util_60pct_cnt.week_start_date \u003d torque_util_80pct_cnt.week_start_date\n)\nLEFT OUTER JOIN (\n    SELECT vehicle_id, week_start_date, COUNT(*) AS ft_torque_util_90pct_s\n    FROM (\n        SELECT vehicle_id, week_start_date\n        FROM engine_temp\n        WHERE torque_utilization \u003e\u003d 0.9 AND torque_utilization \u003c 1\n    ) torque_util_80pct\n    GROUP BY vehicle_id, week_start_date\n) torque_util_90pct_cnt\nON (\n    torque_util_60pct_cnt.vehicle_id \u003d torque_util_90pct_cnt.vehicle_id\n    AND torque_util_60pct_cnt.week_start_date \u003d torque_util_90pct_cnt.week_start_date\n)\nLEFT OUTER JOIN (\n    SELECT vehicle_id, week_start_date, COUNT(*) AS ft_horsepower_util_50pct_s\n    FROM (\n        SELECT vehicle_id, week_start_date\n        FROM engine_temp\n        WHERE horsepower_utilization \u003e\u003d 0.5 AND horsepower_utilization \u003c 0.6\n    ) hp_util_50pct\n    GROUP BY vehicle_id, week_start_date\n) hp_util_50pct_cnt\nON (\n    torque_util_60pct_cnt.vehicle_id \u003d hp_util_50pct_cnt.vehicle_id\n    AND torque_util_60pct_cnt.week_start_date \u003d hp_util_50pct_cnt.week_start_date\n)\nLEFT OUTER JOIN (\n    SELECT vehicle_id, week_start_date, COUNT(*) AS ft_horsepower_util_60pct_s\n    FROM (\n        SELECT vehicle_id, week_start_date\n        FROM engine_temp\n        WHERE horsepower_utilization \u003e\u003d 0.6 AND horsepower_utilization \u003c 0.7\n    ) hp_util_60pct\n    GROUP BY vehicle_id, week_start_date\n) hp_util_60pct_cnt\nON (\n    torque_util_60pct_cnt.vehicle_id \u003d hp_util_60pct_cnt.vehicle_id\n    AND torque_util_60pct_cnt.week_start_date \u003d hp_util_60pct_cnt.week_start_date\n)\nLEFT OUTER JOIN (\n    SELECT vehicle_id, week_start_date, COUNT(*) AS ft_horsepower_util_70pct_s\n    FROM (\n        SELECT vehicle_id, week_start_date\n        FROM engine_temp\n        WHERE horsepower_utilization \u003e\u003d 0.7 AND horsepower_utilization \u003c 0.8\n    ) hp_util_80pct\n    GROUP BY vehicle_id, week_start_date\n) hp_util_70pct_cnt\nON (\n    torque_util_60pct_cnt.vehicle_id \u003d hp_util_70pct_cnt.vehicle_id\n    AND torque_util_60pct_cnt.week_start_date \u003d hp_util_70pct_cnt.week_start_date\n)\nLEFT OUTER JOIN (\n    SELECT vehicle_id, week_start_date, COUNT(*) AS ft_horsepower_util_80pct_s\n    FROM (\n        SELECT vehicle_id, week_start_date\n        FROM engine_temp\n        WHERE horsepower_utilization \u003e\u003d 0.8 AND horsepower_utilization \u003c 0.9\n    ) hp_util_80pct\n    GROUP BY vehicle_id, week_start_date\n) hp_util_80pct_cnt\nON (\n    torque_util_60pct_cnt.vehicle_id \u003d hp_util_80pct_cnt.vehicle_id\n    AND torque_util_60pct_cnt.week_start_date \u003d hp_util_80pct_cnt.week_start_date\n)\nLEFT OUTER JOIN (\n    SELECT vehicle_id, week_start_date, COUNT(*) AS ft_rpm_util_50pct_s\n    FROM (\n        SELECT vehicle_id, week_start_date\n        FROM engine_temp\n        WHERE rpm_utilization \u003e\u003d 0.5 AND horsepower_utilization \u003c 0.6\n    ) rpm_util_50pct\n    GROUP BY vehicle_id, week_start_date\n) rpm_util_50pct_cnt\nON (\n    torque_util_60pct_cnt.vehicle_id \u003d rpm_util_50pct_cnt.vehicle_id\n    AND torque_util_60pct_cnt.week_start_date \u003d rpm_util_50pct_cnt.week_start_date\n)\nLEFT OUTER JOIN (\n    SELECT vehicle_id, week_start_date, COUNT(*) AS ft_rpm_util_60pct_s\n    FROM (\n        SELECT vehicle_id, week_start_date\n        FROM engine_temp\n        WHERE rpm_utilization \u003e\u003d 0.6 AND horsepower_utilization \u003c 0.7\n    ) rpm_util_60pct\n    GROUP BY vehicle_id, week_start_date\n) rpm_util_60pct_cnt\nON (\n    torque_util_60pct_cnt.vehicle_id \u003d rpm_util_60pct_cnt.vehicle_id\n    AND torque_util_60pct_cnt.week_start_date \u003d rpm_util_60pct_cnt.week_start_date\n)\nORDER BY vehicle_id, week_start_date\n",
      "user": "anonymous",
      "dateUpdated": "2020-04-14 22:19:37.305",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "vehicle_id": "string",
                      "week_start_date": "string",
                      "ft_torque_util_60pct_s": "string",
                      "ft_torque_util_70pct_s": "string",
                      "ft_torque_util_80pct_s": "string",
                      "ft_torque_util_90pct_s": "string",
                      "ft_horsepower_util_50pct_s": "string",
                      "ft_horsepower_util_60pct_s": "string",
                      "ft_horsepower_util_70pct_s": "string",
                      "ft_horsepower_util_80pct_s": "string",
                      "ft_rpm_util_50pct_s": "string",
                      "ft_rpm_util_60pct_s": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/text"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : -1"
          }
        ]
      },
      "apps": [],
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1579702319835_1558290495",
      "id": "20200122-141159_2015466826",
      "dateCreated": "2020-01-22 14:11:59.835",
      "dateStarted": "2020-04-14 22:19:37.311",
      "dateFinished": "2020-04-14 22:19:59.830",
      "status": "FINISHED"
    },
    {
      "text": "%hive\nSELECT * FROM engine_features",
      "user": "anonymous",
      "dateUpdated": "2020-04-14 22:19:30.952",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "engine_features.vehicle_id": "string",
                      "engine_features.week_start_date": "string",
                      "engine_features.ft_torque_util_60pct_s": "string",
                      "engine_features.ft_torque_util_70pct_s": "string",
                      "engine_features.ft_torque_util_80pct_s": "string",
                      "engine_features.ft_torque_util_90pct_s": "string",
                      "engine_features.ft_horsepower_util_50pct_s": "string",
                      "engine_features.ft_horsepower_util_60pct_s": "string",
                      "engine_features.ft_horsepower_util_70pct_s": "string",
                      "engine_features.ft_horsepower_util_80pct_s": "string",
                      "engine_features.ft_rpm_util_50pct_s": "string",
                      "engine_features.ft_rpm_util_60pct_s": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "editorSetting": {
          "language": "text",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/text"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "org.apache.hive.service.cli.HiveSQLException: Error while compiling statement: FAILED: SemanticException [Error 10001]: Line 1:14 Table not found \u0027engine_features\u0027\n\tat org.apache.hive.jdbc.Utils.verifySuccess(Utils.java:300)\n\tat org.apache.hive.jdbc.Utils.verifySuccessWithInfo(Utils.java:286)\n\tat org.apache.hive.jdbc.HiveStatement.runAsyncOnServer(HiveStatement.java:324)\n\tat org.apache.hive.jdbc.HiveStatement.execute(HiveStatement.java:265)\n\tat org.apache.commons.dbcp2.DelegatingStatement.execute(DelegatingStatement.java:291)\n\tat org.apache.commons.dbcp2.DelegatingStatement.execute(DelegatingStatement.java:291)\n\tat org.apache.zeppelin.jdbc.JDBCInterpreter.executeSql(JDBCInterpreter.java:715)\n\tat org.apache.zeppelin.jdbc.JDBCInterpreter.internalInterpret(JDBCInterpreter.java:810)\n\tat org.apache.zeppelin.interpreter.AbstractInterpreter.interpret(AbstractInterpreter.java:47)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:110)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:684)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:577)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:172)\n\tat org.apache.zeppelin.scheduler.AbstractScheduler.runJob(AbstractScheduler.java:130)\n\tat org.apache.zeppelin.scheduler.ParallelScheduler.lambda$runJobInScheduler$0(ParallelScheduler.java:39)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.hive.service.cli.HiveSQLException: Error while compiling statement: FAILED: SemanticException [Error 10001]: Line 1:14 Table not found \u0027engine_features\u0027\n\tat org.apache.hive.service.cli.operation.Operation.toSQLException(Operation.java:335)\n\tat org.apache.hive.service.cli.operation.SQLOperation.prepare(SQLOperation.java:199)\n\tat org.apache.hive.service.cli.operation.SQLOperation.runInternal(SQLOperation.java:260)\n\tat org.apache.hive.service.cli.operation.Operation.run(Operation.java:247)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatementInternal(HiveSessionImpl.java:541)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatementAsync(HiveSessionImpl.java:527)\n\tat org.apache.hive.service.cli.CLIService.executeStatementAsync(CLIService.java:312)\n\tat org.apache.hive.service.cli.thrift.ThriftCLIService.ExecuteStatement(ThriftCLIService.java:562)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1557)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1542)\n\tat org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)\n\tat org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:39)\n\tat org.apache.hive.service.auth.TSetIpAddressProcessor.process(TSetIpAddressProcessor.java:56)\n\tat org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:286)\n\t... 3 more\nCaused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.parse.SemanticException:Line 1:14 Table not found \u0027engine_features\u0027\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getMetaData(SemanticAnalyzer.java:2155)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getMetaData(SemanticAnalyzer.java:2075)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genResolvedParseTree(SemanticAnalyzer.java:12033)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12129)\n\tat org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:330)\n\tat org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:285)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:659)\n\tat org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1826)\n\tat org.apache.hadoop.hive.ql.Driver.compileAndRespond(Driver.java:1773)\n\tat org.apache.hadoop.hive.ql.Driver.compileAndRespond(Driver.java:1768)\n\tat org.apache.hadoop.hive.ql.reexec.ReExecDriver.compileAndRespond(ReExecDriver.java:126)\n\tat org.apache.hive.service.cli.operation.SQLOperation.prepare(SQLOperation.java:197)\n\t... 15 more\n"
          }
        ]
      },
      "apps": [],
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1579727492667_-1643963128",
      "id": "20200122-211132_1662419920",
      "dateCreated": "2020-01-22 21:11:32.667",
      "dateStarted": "2020-04-14 22:19:30.958",
      "dateFinished": "2020-04-14 22:19:30.996",
      "status": "ERROR"
    },
    {
      "text": "%hive\n",
      "user": "anonymous",
      "dateUpdated": "2020-04-06 00:43:38.502",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1586133818501_-837484144",
      "id": "20200406-004338_689428571",
      "dateCreated": "2020-04-06 00:43:38.501",
      "status": "READY"
    }
  ],
  "name": "engine_features",
  "id": "2F1ERX5FU",
  "defaultInterpreterGroup": "spark",
  "version": "0.9.0-preview1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "spark:shared_process": [],
    "hive:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}